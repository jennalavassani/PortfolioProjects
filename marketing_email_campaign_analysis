CREATE TABLE email_campaigns (
    date DATE,
    campaign_title TEXT,
    recipients INTEGER,
    open_rates FLOAT, 
    clicks INTEGER,
    percentage_of_clicks FLOAT, 
    unsubscribes INTEGER,
    percent_of_unsubscribes FLOAT 
);

-- Overall performance metrics

SELECT
  COUNT(*) AS total_campaigns,
  AVG(open_rates) AS avg_open_rate,
  AVG(percentage_of_clicks) AS avg_click_rate,
  AVG(percent_of_unsubscribes) AS avg_unsubscribe_rate,
  SUM(recipients) AS total_recipients,
  SUM(clicks) AS total_clicks,
  SUM(unsubscribes) AS total_unsubscribes
FROM email_campaigns;

-- Trend analysis month-over-month

SELECT
  EXTRACT(YEAR FROM date) AS year,
  EXTRACT(MONTH FROM date) AS month,
  AVG(open_rates) AS avg_open_rate,
  AVG(percentage_of_clicks) AS avg_click_rate,
  AVG(percent_of_unsubscribes) AS avg_unsubscribe_rate
FROM email_campaigns
GROUP BY year, month
ORDER BY year, month;

-- Top 3 campaigns by open rate

SELECT campaign_title, open_rates
FROM email_campaigns
ORDER BY open_rates DESC
LIMIT 3;

-- Top 3 campaigns by click rate

SELECT campaign_title, percentage_of_clicks
FROM email_campaigns
ORDER BY percentage_of_clicks DESC
LIMIT 3;

-- Campaigns with the highest unsubscribe rate

SELECT campaign_title, percent_of_unsubscribes
FROM email_campaigns
ORDER BY percent_of_unsubscribes DESC
LIMIT 3;
